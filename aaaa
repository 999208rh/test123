<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Expense Tracker</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-green-50 to-green-100 min-h-screen p-4">

<div class="max-w-6xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden flex flex-col md:flex-row">
  <!-- Header -->
  <div class="bg-green-600 text-white p-6 md:w-1/3 flex flex-col justify-center items-center">
    <h1 class="text-3xl font-bold mb-2 text-center">Личный учёт расходов</h1>
    <p class="text-center opacity-90">Отслеживание расходов по категориям</p>
  </div>
  
  <!-- Main Content -->
  <div class="p-6 md:w-2/3 space-y-6">
    <!-- Input Fields -->
    <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 flex flex-col md:flex-row md:space-x-4 space-y-4 md:space-y-0">
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-1">Категория</label>
        <select id="category" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
          <option value="Food">Еда</option>
          <option value="Transport">Транспорт</option>
          <option value="Bills">Коммунальные</option>
          <option value="Shopping">Покупки</option>
          <option value="Others">Другое</option>
        </select>
      </div>
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-1">Сумма</label>
        <input type="number" id="amount" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Введите сумму">
      </div>
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-1">Дата (ГГГГ-ММ-ДД)</label>
        <input type="date" id="date" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" value="<?= date('Y-m-d') ?>">
      </div>
    </div>

    <!-- Table of Expenses -->
    <div class="overflow-x-auto">
      <table class="min-w-full border border-gray-300 rounded-lg">
        <thead class="bg-gray-200">
          <tr>
            <th class="border px-4 py-2">Категория</th>
            <th class="border px-4 py-2">Сумма</th>
            <th class="border px-4 py-2">Дата</th>
            <th class="border px-4 py-2">Действия</th>
          </tr>
        </thead>
        <tbody id="expense-table-body" class="bg-white"></tbody>
      </table>
    </div>

    <!-- Total and Buttons -->
    <div class="flex justify-between items-center mt-4">
      <div class="text-xl font-semibold text-gray-800" id="total-display">Итого: $0.0</div>
      <div class="space-x-4">
        <button id="add-btn" class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md shadow-md transition">Добавить</button>
        <button id="delete-btn" class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md shadow-md transition">Удалить выбранное</button>
      </div>
    </div>
  </div>
</div>

<!-- Script for logic -->
<script>
  const expenseList = [];

  const amountInput = document.getElementById('amount');
  const categorySelect = document.getElementById('category');
  const dateInput = document.getElementById('date');
  const tableBody = document.getElementById('expense-table-body');
  const totalDisplay = document.getElementById('total-display');

  // Add Expense
  document.getElementById('add-btn').addEventListener('click', () => {
    const category = categorySelect.value;
    const amountStr = amountInput.value.trim();
    const date = dateInput.value;

    if (!amountStr || isNaN(amountStr) || parseFloat(amountStr) <= 0) {
      alert('Пожалуйста, введите корректную сумму!');
      return;
    }

    const amount = parseFloat(amountStr);
    const expense = { category, amount, date };
    expenseList.push(expense);
    addExpenseToTable(expense);
    amountInput.value = '';
    updateTotal();
  });

  // Delete selected expense
  document.getElementById('delete-btn').addEventListener('click', () => {
    const selectedRow = document.querySelector('input[type="checkbox"]:checked');
    if (!selectedRow) {
      alert('Пожалуйста, выберите строку для удаления.');
      return;
    }
    const row = selectedRow.closest('tr');
    const index = Array.from(tableBody.children).indexOf(row);
    expenseList.splice(index, 1);
    row.remove();
    updateTotal();
  });

  function addExpenseToTable(expense) {
    const row = document.createElement('tr');

    const cellCategory = document.createElement('td');
    cellCategory.className = 'border px-4 py-2';
    cellCategory.innerText = expense.category;
    row.appendChild(cellCategory);

    const cellAmount = document.createElement('td');
    cellAmount.className = 'border px-4 py-2';
    cellAmount.innerText = `$${expense.amount.toFixed(2)}`;
    row.appendChild(cellAmount);

    const cellDate = document.createElement('td');
    cellDate.className = 'border px-4 py-2';
    cellDate.innerText = expense.date;
    row.appendChild(cellDate);

    const cellAction = document.createElement('td');
    cellAction.className = 'border px-4 py-2 text-center';
    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.className = 'mx-auto';
    cellAction.appendChild(checkbox);
    row.appendChild(cellAction);

    tableBody.appendChild(row);
  }

  function updateTotal() {
    let total = 0;
    for (const exp of expenseList) {
      total += exp.amount;
    }
    totalDisplay.innerText = `Итого: $${total.toFixed(2)}`;
  }
</script>
</body>
</html>
